version: 2

jobs:
  # Core
#  python-2.7-core:
#    docker:
#      - image: circleci/python:2.7-stretch-node-browsers
#
#    steps:
#      - checkout
#      - run:
#          name: install colorlover
#          command: pip install .
#      - run:
#          name: run tests
#          command: python -m unittest tests.py

  python-3.5-core:
    docker:
    - image: continuumio/miniconda3:4.5.12

    steps:
      - run:
          name: create env
          command: |
            conda create -y -n colorlover_env python=3.5 nose coverage
            source activate colorlover_env

            git clone https://github.com/jackparmer/colorlover.git
            cd colorlover
            git checkout ${CIRCLE_BRANCH}
            pip install -I .
            cd .. && python -c "import colorlover"
            cd colorlover
            nosetests -xv tests.py --with-coverage
            mkdir ../artifacts/
            coverage html -d ../artifacts
            zip artifacts.zip artifacts/*
      - store_artifacts:
          path: artifacts.zip

#  python-3.7-core:
#    docker:
#    - image: circleci/python:3.7-stretch-node-browsers
#
#    steps:
#      - checkout
#      - run:
#          name: install colorlover
#          command: pip install .
#      - run:
#          name: run tests
#          command: python -m unittest tests.py

workflows:
  version: 2
  build:
    jobs:
#      - python-2.7-core
      - python-3.5-core
#      - python-3.7-core
