version: 2

jobs:
  # Core
#  python-2.7-core:
#    docker:
#      - image: circleci/python:2.7-stretch-node-browsers
#
#    steps:
#      - checkout
#      - run:
#          name: install colorlover
#          command: pip install .
#      - run:
#          name: run tests
#          command: python -m unittest tests.py

  python-3.5-core:
    docker:
    - image: continuumio/miniconda3:4.5.4

    steps:
      - run:
          name: checkout / setup
          command: |
            git clone https://github.com/jackparmer/colorlover.git
            cd colorlover
            git checkout ${CIRCLE_BRANCH}
            pip install --user nose coverage
            pip install .
      - run:
          name: test install
          command: cd ~ && python -c "import colorlover"
      - run:
          name: run tests
          command: nosetests -xv colorlover/tests.py --with-coverage
      - run:
          name: upload artifacts
          command: |
              mkdir artifacts/
              cd colorlover
              coverage html -d ../artifacts
      - store_artifacts:
          path: artifacts

#  python-3.7-core:
#    docker:
#    - image: circleci/python:3.7-stretch-node-browsers
#
#    steps:
#      - checkout
#      - run:
#          name: install colorlover
#          command: pip install .
#      - run:
#          name: run tests
#          command: python -m unittest tests.py

workflows:
  version: 2
  build:
    jobs:
#      - python-2.7-core
      - python-3.5-core
#      - python-3.7-core
